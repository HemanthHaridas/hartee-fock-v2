#include "elements.h"

#include <stdexcept>

/*
 * Periodic table: H (1) â†’ Es (99)
 * Data obtained from PubChem
 */
const std::array<ElementData, 99> periodic_table_hash = {{{"H", 1, 1.008, 1.200}, {"He", 2, 4.003, 1.400}, {"Li", 3, 7.000, 1.820}, {"Be", 4, 9.012, 1.530}, {"B", 5, 10.810, 1.920}, {"C", 6, 12.011, 1.700}, {"N", 7, 14.007, 1.550}, {"O", 8, 15.999, 1.520}, {"F", 9, 18.998, 1.350}, {"Ne", 10, 20.180, 1.540}, {"Na", 11, 22.990, 2.270}, {"Mg", 12, 24.305, 1.730}, {"Al", 13, 26.982, 1.840}, {"Si", 14, 28.085, 2.100}, {"P", 15, 30.974, 1.800}, {"S", 16, 32.070, 1.800}, {"Cl", 17, 35.450, 1.750}, {"Ar", 18, 39.900, 1.880}, {"K", 19, 39.098, 2.750}, {"Ca", 20, 40.080, 2.310}, {"Sc", 21, 44.956, 2.110}, {"Ti", 22, 47.867, 1.870}, {"V", 23, 50.942, 1.790}, {"Cr", 24, 51.996, 1.890}, {"Mn", 25, 54.938, 1.970}, {"Fe", 26, 55.840, 1.940}, {"Co", 27, 58.933, 1.920}, {"Ni", 28, 58.693, 1.630}, {"Cu", 29, 63.550, 1.400}, {"Zn", 30, 65.400, 1.390}, {"Ga", 31, 69.723, 1.870}, {"Ge", 32, 72.630, 2.110}, {"As", 33, 74.922, 1.850}, {"Se", 34, 78.970, 1.900}, {"Br", 35, 79.900, 1.830}, {"Kr", 36, 83.800, 2.020}, {"Rb", 37, 85.468, 3.030}, {"Sr", 38, 87.620, 2.490}, {"Y", 39, 88.906, 2.190}, {"Zr", 40, 91.220, 1.860}, {"Nb", 41, 92.906, 2.070}, {"Mo", 42, 95.950, 2.090}, {"Tc", 43, 96.906, 2.090}, {"Ru", 44, 101.100, 2.070}, {"Rh", 45, 102.906, 1.950}, {"Pd", 46, 106.420, 2.020}, {"Ag", 47, 107.868, 1.720}, {"Cd", 48, 112.410, 1.580}, {"In", 49, 114.818, 1.930}, {"Sn", 50, 118.710, 2.170}, {"Sb", 51, 121.760, 2.060}, {"Te", 52, 127.600, 2.060}, {"I", 53, 126.905, 1.980}, {"Xe", 54, 131.290, 2.160}, {"Cs", 55, 132.905, 3.430}, {"Ba", 56, 137.330, 2.680}, {"La", 57, 138.906, 2.400}, {"Ce", 58, 140.116, 2.350}, {"Pr", 59, 140.908, 2.390}, {"Nd", 60, 144.240, 2.290}, {"Pm", 61, 144.913, 2.360}, {"Sm", 62, 150.400, 2.290}, {"Eu", 63, 151.964, 2.330}, {"Gd", 64, 157.200, 2.370}, {"Tb", 65, 158.925, 2.210}, {"Dy", 66, 162.500, 2.290}, {"Ho", 67, 164.930, 2.160}, {"Er", 68, 167.260, 2.350}, {"Tm", 69, 168.934, 2.270}, {"Yb", 70, 173.050, 2.420}, {"Lu", 71, 174.967, 2.210}, {"Hf", 72, 178.490, 2.120}, {"Ta", 73, 180.948, 2.170}, {"W", 74, 183.840, 2.100}, {"Re", 75, 186.207, 2.170}, {"Os", 76, 190.200, 2.160}, {"Ir", 77, 192.220, 2.020}, {"Pt", 78, 195.080, 2.090}, {"Au", 79, 196.967, 1.660}, {"Hg", 80, 200.590, 2.090}, {"Tl", 81, 204.383, 1.960}, {"Pb", 82, 207.000, 2.020}, {"Bi", 83, 208.980, 2.070}, {"Po", 84, 208.982, 1.970}, {"At", 85, 209.987, 2.020}, {"Rn", 86, 222.018, 2.200}, {"Fr", 87, 223.020, 3.480}, {"Ra", 88, 226.025, 2.830}, {"Ac", 89, 227.028, 2.600}, {"Th", 90, 232.038, 2.370}, {"Pa", 91, 231.036, 2.430}, {"U", 92, 238.029, 2.400}, {"Np", 93, 237.048, 2.210}, {"Pu", 94, 244.064, 2.430}, {"Am", 95, 243.061, 2.440}, {"Cm", 96, 247.070, 2.450}, {"Bk", 97, 247.070, 2.440}, {"Cf", 98, 251.080, 2.450}, {"Es", 99, 252.083, 2.450}}};

const ElementData &element_from_symbol(std::string_view symbol)
{
    for (const auto &e : periodic_table_hash)
        if (e.symbol == symbol)
            return e;

    throw std::runtime_error("Unknown atomic symbol");
}

const ElementData &element_from_z(std::uint64_t Z)
{
    for (const auto &e : periodic_table_hash)
        if (e.Z == Z)
            return e;

    throw std::runtime_error("Invalid atomic number");
}
